---
title: 'Linked List: A Comprehensive Guide'
date: '2021-04-08'
lastmod: '2021-04-08'
tags: ['dsa']
summary: 'A comprehensive guide to linked list in C++'
images: ['/static/blog/linked-list/fig-1.png']
---

### 1. Introduction
Danh sÃ¡ch liÃªn káº¿t lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u tuyáº¿n tÃ­nh, trong Ä‘Ã³ cÃ¡c pháº§n tá»­ khÃ´ng Ä‘Æ°á»£c lÆ°u trá»¯ táº¡i cÃ¡c vá»‹ trÃ­ bá»™ nhá»› liá»n ká». CÃ¡c pháº§n tá»­ trong danh sÃ¡ch Ä‘Æ°á»£c liÃªn káº¿t Ä‘Æ°á»£c liÃªn káº¿t báº±ng cÃ¡ch sá»­ dá»¥ng con trá» nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh áº£nh bÃªn dÆ°á»›i:

<div style={{ textAlign: "center" }}>
    <img
        id="figure-1"
        src="/static/blog/linked-list/fig-1.png"
        alt="Linked List Diagram"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 1: Linked List Diagram</p>
</div>

Báº¯t Ä‘áº§u vá»›i cáº¥u trÃºc Ä‘Æ¡n giáº£n nháº¥t
```cpp
struct Node {
    int data;
    Node *next;
};
```

Trong hÃ m main ta khai bÃ¡o nhÆ° sau:
```cpp
int main() {
    Node *one = new Node();
    Node *two = new Node();
    Node *three = new Node();
    // Set one is head
    Node *head = one;
    
    // Set value
    one->data = 1;
    two->data = 2;
    three->data = 3;

    // Link
    one->next = two;
    two->next = three;
    // head -> next -> next
    // one -> two -> three
}
```
NhÆ° váº­y chÃºng ta Ä‘Ã£ cÃ³ má»™t list. Giá» chÃºng ta muá»‘n thÃªm má»™t pháº§n tá»­ zero vÃ o má»™t vá»‹ trÃ­ báº¥t kÃ¬ thÃ¬ lÃ m tháº¿ nÃ o?

### 2. ThÃªm pháº§n tá»­ vÃ o Ä‘áº§u danh sÃ¡ch liÃªn káº¿t
<div style={{ textAlign: "center" }}>
    <img
        id="figure-2"
        src="/static/blog/linked-list/fig-2.png"
        alt="Add Node to Head"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 2: Add Node to Head</p>
</div>

#### 2.1. Code
<div id="add-head">
```cpp
void addhead(int data, Node **head) {
    Node* new_head = new Node();
    new_head->data = data;
    new_head->next = *head;
    *head = new_head;
}
```
</div>

#### 2.2. Test
```cpp
int main() {
    ...
    addhead(0, &head); // set head->data = 0
    cout << head->data; // head->data = 0 
}
```
Cho nhá»¯ng báº¡n chÆ°a hiá»ƒu táº¡i sao trong hÃ m [`addhead(0, &head)`](#add-head), `&head` á»Ÿ Ä‘Ã¢y cÃ³ nghÄ©a chÃºng ta Ä‘ang cho vÃ o Ä‘á»‹a trá»‰ cá»§a má»™t biáº¿n con trá».

ChÃºng ta Ä‘Æ°a vÃ o Ä‘á»‹a trá»‰ Ä‘á»ƒ thay Ä‘á»•i giÃ¡ trá»‹ nÃ³, cÃ¡i nÃ y gá»i lÃ  tham chiáº¿u, cÃ²n náº¿u lÃ  `Node *head` thÃ¬ chá»‰ truyá»n vÃ o giÃ¡ trá»‹, ta khÃ´ng thay Ä‘á»•i Ä‘Æ°á»£c sau khi káº¿t thÃºc hÃ m, Ä‘Ã³ gá»i lÃ  tham trá»‹.

### 3. ThÃªm sau má»™t vá»‹ trÃ­ cho trÆ°á»›c
<div style={{ textAlign: "center" }}>
    <img
        id="figure-3"
        src="/static/blog/linked-list/fig-3.png"
        alt="Add Node After"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 3: Add Node After</p>
</div>

#### 3.1. Code
<div id="add-after">
```cpp
void insertAfter(Node *index, int data) {
    if (index == NULL) return;
    Node *new_node = new Node();
    new_node->data = data;
    new_node->next = index->next;
    index->next = new_node;
}
```
</div>
Pháº§n nÃ y khÃ¡ dá»… hiá»ƒu má»i ngÆ°á»i hÃ£y nhÃ¬n hÃ¬nh [Figure 3](#figure-3) sáº½ hiá»ƒu.

### 4. ThÃªm vÃ o cuá»‘i danh sÃ¡ch
<div style={{ textAlign: "center" }}>
    <img
        id="figure-4"
        src="/static/blog/linked-list/fig-4.png"
        alt="Add Node to Tail"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 4: Add Node to Tail</p>
</div>

#### 4.1. Code
<div id="add-tail">
```cpp
void append(Node **head, int data) {
    Node *new_node = new Node();
    new_node->data = data;
    if (*head == NULL) {
        *head = new_node;
        return;
    }
    Node *tmp = *head;
    while(tmp->next != NULL) {
        tmp = tmp->next;
    }
    tmp->next = new_node;
}
```
</div>

#### 4.2. Test
```cpp
void printlist(Node *node) {
    while(node) {
        cout << node->data << " ";
        node = node->next;
    }
}

int main() {
    Node *head = NULL;
    append(&head, 0);
    append(&head, 1);
    append(&head, 2);
    append(&head, 3);
    append(&head, 4);
    printlist(head);
    return 0;
}
```
Káº¿t quáº£ sáº½ lÃ  `0 1 2 3 4`.

### 5. XÃ³a pháº§n tá»­ cÃ³ giÃ¡ trá»‹ báº±ng x
Cho má»™t Linked List chÃºng ta hay xÃ³a pháº§n tá»­ cÃ³ $value = x$

#### 5.1. Code
<div id="delete-node">
```cpp
void delete_value(Node **head, int x) {
    Node *tmp = *head;
    Node *prev = NULL;
    if (*head == NULL) return;
    if (tmp->data == x) {
        *head = tmp->next;
        delete tmp;
    } else {
        while(tmp->data != x) {
            prev = tmp;
            tmp = tmp->next;
        }
        prev->next = tmp->next;
        delete tmp;
    }  
}
```
</div>

### 6. XÃ³a pháº§n tá»­ táº¡i vá»‹ trÃ­ cho trÆ°á»›c
#### 6.1. Code
<div id="delete-index">
```cpp
void delete_pos(Node **head, int pos) {
    if (*head == NULL) return;
    Node *tmp = *head;
    if(pos == 0) {
        *head = tmp->next;
        delete tmp;
        return;
    }
    pos--;
    while(pos--) {
        tmp = tmp->next;
    }
    Node *aft = tmp->next->next;
    delete tmp->next;
    tmp->next = aft;
}
```
</div>

Xem hoáº¡t áº£nh sau Ä‘á»ƒ cÃ³ thá»ƒ dá»… dÃ ng hiá»ƒu:

<div style={{ textAlign: "center" }}>
    <img
        id="figure-5"
        src="/static/blog/linked-list/fig-5.gif"
        alt="Delete Node at Index"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 5: Delete Node at Index</p>
</div>

### 7. XÃ³a má»™t Linked List?
#### 7.1. Code
<div id="delete-list">
```cpp
void delete_list(Node **head) {
    Node *curr = *head;
    Node *next = NULL;
    while(curr) {
        next = curr->next;
        delete curr;
        curr = next;
    }
    *head = NULL;
}
```
</div>
### 8. TÃ¬m Ä‘á»™ dÃ i cá»§a Linked List
#### 8.1. Code
<div id="length-list">
```cpp
int len_list(Node *head) {
    if (head == NULL) return 0;
    int len = 0;
    while(head) {
        len++;
        head = head->next;
    }
    return len;
} 
```
</div>

á» Ä‘Ã¢y chÃºng ta chá»‰ cáº§n xÃ©t giÃ¡ trá»‹ khÃ´ng cáº§n thiáº¿t phÃ i `Node **head` Ä‘á»ƒ truy Ä‘áº¿n Ä‘á»‹a trá»‰, chÃºng ta chá»‰ cáº§n biáº¿n Ä‘áº¿m vÃ  khÃ´ng cáº§n thay Ä‘á»•i giÃ¡ trá»‹ gÃ¬ cáº£ ğŸ˜™.

### 9. Check xem trong Linked List cÃ³ giÃ¡ trá»‹ nÃ o báº±ng x khÃ´ng:
#### 9.1. Code
<div id="check-value">
```cpp
bool find(Node *head, int x) {
    while(head) {
        if (head->data == x) return true;
        head = head->next;
    }
    return false;
}
```
</div>

### 10. Láº¥y giÃ¡ trá»‹ táº¡i vá»‹ trÃ­ cho trÆ°á»›c
#### 10.1. Code
<div id="get-value">
```cpp
int getNth (Node *head, int index) {
    int len = len_list(head);
    if (index > len) return -1;
    while(index--) {
        head = head->next;
    }
    return head->data;
}
```
</div>

### 11. TÃ¬m Ä‘á»™ dÃ i cá»§a LOOP trong Linked List
<div style={{ textAlign: "center" }}>
    <img
        id="figure-6"
        src="/static/blog/linked-list/fig-6.png"
        alt="Find Loop Length"
        style={{ width: "80%", display: "block", margin: "0 auto" }}
    />
    <p style={{ textAlign: "center" }}>Figure 6: Find Loop Length</p>
</div>

### 11.1. Äáº§u tiÃªn hay tÃ¬m hiá»ƒu cÃ¡ch kiá»ƒm tra xem cÃ³ loop trong linked list hay khÃ´ng?
<div id="loop-detect">
```cpp
bool loopDetect(Node *head) {
    Node *fast = head;
    Node *slow = head;
    while (fast && slow && fast->next) {
        if (fast == slow) return true;
        fast = fast->next->next;
        slow = slow->next;
    }
    return false;
}
```
</div>
Ta cho `slow`, `fast` cháº¡y cho Ä‘áº¿n khi hai con trá» báº±ng nhau thÃ¬ chá»©ng tá» cÃ³ LOOP. Dá»… hiá»ƒu Ä‘Ãºng khÃ´ng?

CÃ²n má»™t cÃ¡ch ná»¯a lÃ  sá»­ dá»¥ng `Set`:
<div id="loop-detect-set">
```cpp
bool loopDetect(Node *head) {
    set<Node *> s;
    while(head) {
        if (s.find(head) != s.end()) {
            return true;
        } else {
            s.insert(head);
            head = head->next;
        }   
    }
    return false;
}
```
</div>

### 11.2. TÃ¬m Ä‘á»™ dÃ i cá»§a LOOP
ChÃºng ta Ä‘Ã£ cÃ³ cÃ¡ch kiá»ƒm tra vÃ  biáº¿t vá»‹ trÃ­ LOOP chÃ­nh lÃ  táº¡i `slow` || `fast` táº¡i thá»i Ä‘iá»ƒm nÃ³ báº±ng nhau. Giá» hay tiáº¿p vá»›i hÃ m tÃ¬m Ä‘á»™ dÃ i cá»§a LOOP nÃ y.
<div id="count-from">
```cpp
int countFrom(Node *loopIndex) {
    int len = 1;
    Node *tmp = loopIndex;
    while(tmp->next != loopIndex) {
        len++;
        tmp = tmp->next;
    }
    return len;
}
```
</div>
HÃ m [`countFrom`](#count-from) lÃ  hÃ m Ä‘áº¿m Ä‘á»™ dÃ i vÃ  input lÃ  con trá» táº¡i vá»‹ trÃ­ cÃ³ LOOP, tá»©c lÃ  vá»‹ trÃ­ `end->next`, Ä‘Ã£ Ä‘i Ä‘áº¿n Ä‘Ã¢y thÃ¬ báº¡n sáº½ dá»… dÃ ng hiá»ƒu Ä‘Æ°á»£c hÃ m.
<div id="count-loop">
```cpp
int countLoop(Node *head) {
    Node *slow = head;
    Node *fast = head;
    while (slow && fast && fast->next) {
        slow = slow->next;
        fast = fast->next->next;
        if (fast == slow) {
        return countFrom(slow);
        // or return countfrom(fast);
        }
    }
    return 0;
}
```
</div>

### 12. XÃ³a pháº§n tá»­ láº·p cá»§a má»™t Linked List chÆ°a Ä‘Æ°á»£c sáº¯p xáº¿p:
#### 12.1. Code
<div id="remove-duplicate">
```cpp
void removeDuplicates (Node **head) {
    Node *curr = *head;
    Node *prev = NULL;
    unordered_set<int> s;
    while(curr) {
        if (s.find(curr->data) != s.end()) {
            prev->next = curr->next;
            delete curr;
        } else {
            s.insert(curr->data);
            prev = curr;
        }
        curr = prev->next;
    }
    // do phuc tap la O(n)
}
```
</div>

Ta sáº½ sá»­ dá»¥ng `Hashing` Ä‘á»ƒ cÃ³ thá»ƒ cÃ³ Ä‘á»™ phá»©c táº¡p lÃ  $O(n)$.

### 13. Intersection of Two Linked Lists (LeetCode) | Giao Ä‘iá»ƒm cá»§a hai danh sÃ¡ch Ä‘Æ°á»£c liÃªn káº¿t.
#### 13.1. Code
<div id="intersection">
```cpp
Node *getIntersectionNode (Node *headA, Node *headB) {
    set<Node *> s;
    while(headA) {
        s.insert(headA);
        headA = headA->next;
    }
    while(headB) {
        if (s.find(headB) != s.end()) {
            return headB;
        } else {
            s.insert(headB);
            headB = headB->next;
        }
    }
    return NULL;
}
```
</div>

### 14. Reverse Linked Lists (LeetCode) | Äáº£o ngÆ°á»£c Linked List
#### 14.1. Code
<div id="reverse-list">
```cpp
Node *reverseList(Node **head) {
    Node *curr = *head;
    Node *prev = NULL;
    while (curr) {
        Node *tmp = curr->next;
        curr->next = prev;
        prev = curr;
        curr = tmp;
    }
    return prev;
}
```
</div>
- Time complexity : $O(n)$. Assume that $n$ is the list's length, the time complexity is $O(n)$.
- Space complexity : $O(1)$.

### 15. Remove Elements (LeetCode)
#### 15.1. Code
<div id="remove-elements">
```cpp
Node *removeElements(Node **head, int value) {
    Node *curr = head;
    Node *prev = new Node();
    prev->next = head; 
    // prev slower than curr 1 step
    while(curr) {
        if(curr->value == value) {
            prev->next = curr->next;
        } else {
            prev = prev->next;
        }
        curr = curr->next;
    }
    return *head;
}
```
</div>

### 16. Odd Even Linked List (LeetCode)
<div style={{ textAlign: "center"}}>
    <img
        id="figure-7"
        src="/static/blog/linked-list/fig-7.svg"
        alt="Odd Even Linked List"
        style={{ width: "80%", display: "block", margin: "0 auto", backgroundColor: "white"  }}
    />
    <p style={{ textAlign: "center" }}>Figure 7: Odd Even Linked List</p>
</div>

á» Ä‘Ã¢y bÃ i toÃ¡n máº·c Ä‘á»‹nh pháº§n tá»­ Ä‘áº§u tiÃªn lÃ  láº», pháº§n tá»­ thá»© hai lÃ  cháºµn, ta sáº½ giáº£i quyáº¿t theo hÆ°á»›ng chia ra lÃ m hai list rá»“i ná»‘i chÃºng láº¡i vá»›i nhau.
#### 16.1. Code
<div id="odd-even">
```cpp
Node *oddevenList(Node **head) {
    Node *odd = *head;
    Node *even = odd->next;
    Node *evenHead = even;
    while(even && even->next) {
        odd->next = even->next;
        odd = odd->next;
        even->next = odd->next;
        even = even->next;
    }
    odd->next = evenHead;
    return *head;
}
```
</div>

> [!NOTE]
> To be updated